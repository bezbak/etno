{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>–≠—Ç–Ω–æ –∫–∞—Ñ–µ ‚Äî –º–µ–Ω—é</title>
  <meta name="description" content="–≠—Ç–Ω–æ –∫–∞—Ñ–µ. –ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∫—É—Ö–Ω—è. –ú–µ–Ω—é." />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="shortcut icon" href="{% static '–ª–æ–≥–æ —ç—Ç–Ω–æ.png' %}" type="image/x-icon">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
#tabs::-webkit-scrollbar {
  height: 6px;
}

#tabs::-webkit-scrollbar-track {
  background: transparent;
}

#tabs::-webkit-scrollbar-thumb {
  background-color: rgba(255, 255, 255, 0.72);
  border-radius: 999px;
}

#tabs::-webkit-scrollbar-thumb:hover {
  background-color: rgba(139, 58, 58, 0.6);
}

/* Firefox */
#tabs {
  scrollbar-width: thin;
  scrollbar-color: rgba(255, 255, 255, 0.4) transparent;
}
</style>
</head>

<body class="bg-[#efe3d0] text-[#3a2a1a] "style="background-image: url('{%static 'bgh.png'%}');background-size: cover;">
<svg width="0" height="0" class="hidden">
  <!-- –§–æ–Ω–æ–≤—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω -->
  <pattern id="ethno-bg" width="120" height="120" patternUnits="userSpaceOnUse">
    <path d="M60 0 L120 60 L60 120 L0 60 Z"
          fill="none"
          stroke="#c9a46a"
          stroke-width="2"
          opacity="0.25"/>
  </pattern>

  <!-- –†–∞–º–∫–∞ -->
  <pattern id="ethno-border" width="40" height="40" patternUnits="userSpaceOnUse">
    <path d="M0 20 Q20 0 40 20 Q20 40 0 20"
          fill="none"
          stroke="#8b3a3a"
          stroke-width="2"/>
  </pattern>
</svg>



<!-- HEADER -->
<header class="relative text-center py-4 md:py-12 px-4 md:px-16 border-y-4 border-[#8b3a3a]"
         style="background-image: url('{%static 'bgh.png'%}');background-size: cover; background-repeat:no-repeat;">
  <div class="absolute w-full h-full bg-black left-0 top-0" style="opacity: 0.55;"></div>
  <!-- PATTERN GRID -->
<div
  id="pattern-layer"
  class="absolute inset-0 z-0 opacity-40 pointer-events-none">
</div>

  <!-- –£–ì–õ–´ -->
  {% comment %} <img src="/svg/1 441.svg"
       class="absolute bottom-0 left-0 w-32 opacity-25 z-0 pointer-events-none" />
  <img src="/svg/1 441.svg"
       class="absolute bottom-0 right-0 w-32 opacity-25 z-0 scale-x-[-1] pointer-events-none" />
  <img src="/svg/1 441.svg"
       class="absolute top-0 left-0 w-32 opacity-25 z-0 scale-y-[-1] pointer-events-none" />
  <img src="/svg/1 441.svg"
       class="absolute top-0 right-0 w-32 opacity-25 z-0 scale-x-[-1] scale-y-[-1] pointer-events-none" /> {% endcomment %}

  <!-- –ö–û–ù–¢–ï–ù–¢ -->
  <div class="relative z-10 flex flex-col items-center gap-2 md:gap-3 text-[#fefefe]">
    <h1 class="text-4xl font-bold tracking-widest flex items-center justify-center">
      <img src="{% static '–ª–æ–≥–æ —ç—Ç–Ω–æ.png' %}" class="w-40 h-30" alt="">
    </h1>

    <p class="text-4xl font-bold ">–ö–∞—Ñ–µ</p>
    <p class="text-lg font-semibold">–£ –∏—Å—Ç–æ–∫–∞ —Ç—Ä–∞–¥–∏—Ü–∏–π</p>
  </div>

</header>

<section class="relative overflow-hidden" style="background-image: url('{%static 'bg2.png'%}');background-size: cover; min-height:50vh;">
  <div class="absolute w-full h-full bg-black left-0 top-0" style="opacity: 0.4;"></div>

  <!-- –£–ì–õ–´ -->
  <img src="{%static '1 441.svg' %}"
       class="absolute bottom-0 left-0 w-32 opacity-20 z-0" />

  <img src="{%static '1 441.svg' %}"
       class="absolute bottom-0 right-0 w-32 opacity-20 z-0 scale-x-[-1]" />

  <img src="{%static '1 441.svg' %}"
       class="absolute top-0 left-0 w-32 opacity-20 z-0 scale-y-[-1]" />

  <img src="{%static '1 441.svg' %}"
       class="absolute top-0 right-0 w-32 opacity-20 z-0 scale-x-[-1] scale-y-[-1]" />

  <!-- –ö–û–ù–¢–ï–ù–¢ -->
<nav id="tabs"
     class="relative z-10
            flex items-center
            gap-6
            py-6
            px-10
            text-sm font-semibold
            overflow-x-auto
            scrollbar-thin
            scroll-smooth
            whitespace-nowrap">
</nav>

  <main id="menu"
        class="relative z-10 max-w-7xl mx-auto px-4 pb-16">
  </main>

</section>

<!-- FOOTER -->
<footer class="bg-[#3a2a1a] text-[#efe3d0] py-10">
  <div class="max-w-6xl mx-auto px-4 grid md:grid-cols-2 gap-6">
    <div>
      <h3 class="text-xl font-bold mb-2">‚õ∞ –£ –∏—Å—Ç–æ–∫–∞ —Ç—Ä–∞–¥–∏—Ü–∏–π</h3>
      <p>–ó–∞–≤–µ–¥–µ–Ω–∏–µ –¥–ª—è —Ö–æ—Ä–æ—à–µ–≥–æ –≤—Ä–µ–º—è–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è üç∑ü•©</p>
    </div>
    <div class="space-y-1">
      <p class="flex gap-2 text-lg"> –ê–ª—ã–º–±–µ–∫–∞ –î–∞—Ç–∫–∏ 212/1 (–æ—Ä-—Ä –∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä ¬´–ù–£–†¬ª)</p>
      <p>üïê 11:00 ‚Äì 23:00</p>
      <a href="https://www.instagram.com/ethno.cafe"
         target="_blank"
         class="inline-block mt-2 underline w-16 h-16">
        <img src="{% static 'inst.png' %}" style="filter: invert(1);" alt="">
      </a>
    </div>
  </div>
</footer>

<script>
let allData = []
let activeCategory = null

fetch('/api/menu/')
  .then(r => r.json())
  .then(data => {
    allData = data
    renderTabs()
    setCategory(data[0].id)
  })

function renderTabs() {
  const tabs = document.getElementById('tabs')
  tabs.innerHTML = ''

  allData.forEach(cat => {
    const btn = document.createElement('button')
    btn.textContent = cat.name.toUpperCase()
    btn.className = `
      px-4 py-2 
      ${activeCategory === cat.id 
        ? 'text-[#fefefe]' 
        : 'opacity-60 hover:opacity-100 text-[#fefefeeb]'}
    `
    btn.onclick = () => setCategory(cat.id)
    tabs.appendChild(btn)
  })
}

function setCategory(id) {
  activeCategory = id
  renderTabs()

  const category = allData.find(c => c.id === id)
  const root = document.getElementById('menu')

  root.innerHTML = `
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mt-6">
      ${category.dishes.map(d => `
        <div class="bg-white rounded-2xl shadow-lg overflow-hidden border border-[#d6c2a3]">
          
          <div class="h-40 bg-gray-200">
            <img src="${d.image || '/static/no-photo.jpg'}"
                 alt="${d.name}"
                 class="w-full h-full object-cover">
          </div>

          <div class="p-4 space-y-2">
            <h3 class="font-bold text-lg">${d.name}</h3>
            <p class="text-sm opacity-70">${d.description || ''}</p>

            <div class="flex justify-between items-center pt-2">
              <span class="text-sm">${d.weight} –≥</span>
              <span class="font-bold text-[#8b3a3a]">${d.price} —Å–æ–º</span>
            </div>
          </div>

        </div>
      `).join('')}
    </div>
  `
}
</script>
<script>
(() => {
  const patterns = [
    "{% static '2.svg' %}",
    "{% static '3.svg' %}",
    "{% static '4.svg' %}"
  ];

  const layer = document.getElementById("pattern-layer");

  function generatePatterns() {
    layer.innerHTML = "";

    const w = window.innerWidth;
    const h = layer.offsetHeight;

    // –õ–û–ì–ò–ö–ê –ê–î–ê–ü–¢–ê–¶–ò–ò
    const size = w < 640 ? 28 : w < 1024 ? 40 : 48;
    const gap  = w < 640 ? 40 : w < 1024 ? 60 : 80;

    const cols = Math.floor(w / gap);
    const rows = 6

    const count = cols * rows;

    for (let i = 0; i < count; i++) {
      const img = document.createElement("img");

      img.src = patterns[i % patterns.length];
      img.style.width = size + "px";
      img.style.height = "auto";
      img.style.position = "absolute";

      // –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
      const x = (i % cols) * gap + Math.random() * 20;
      const y = Math.floor(i / cols) * gap + Math.random() * 20;

      img.style.left = x + "px";
      img.style.top = y + "px";

      // –ª—ë–≥–∫–∏–π —Ö–∞–æ—Å
      img.style.transform = `rotate(${Math.random() * 30 - 15}deg)`;
      img.style.opacity = "1";

      layer.appendChild(img);
    }
  }

  // –ø–µ—Ä–≤–∏—á–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
  generatePatterns();

  // –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø—Ä–∏ —Ä–µ—Å–∞–π–∑–µ
  let resizeTimeout;
  window.addEventListener("resize", () => {
    clearTimeout(resizeTimeout);
    resizeTimeout = setTimeout(generatePatterns, 150);
  });
})();
</script>

</body>
</html>